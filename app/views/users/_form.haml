- form_for @user do |f|
  = f.error_messages
  = f.hidden_field :id
  %p
    = f.label :username
    %br
    = f.text_field :username
  %p
    = f.label :email
    %br
    = f.text_field :email
  - if @user.openid_identifier.blank?
    %p
      = f.label :password
      %br
      = f.password_field :password
    %p
      = f.label :password_confirmation
      %br
      = f.password_field :password_confirmation
    %p
      = f.label :city
      %br
      = f.text_field :city
    %p
      = f.label :community_id
      %br
      = f.select :community_id, options_from_collection_for_select(@communities, 'id', 'name', :selected => @user.community_id)
    - if admin_logged_in?
      %p
        = f.label :admin
        %br
        = f.check_box :admin
    %p
      = f.submit "Submit"
  %h2
    Or use OpenID
  %p
    = f.label :openid_identifier, "OpenID URL"
    %br
    = f.text_field :openid_identifier
  %p
    = f.submit "Submit"
